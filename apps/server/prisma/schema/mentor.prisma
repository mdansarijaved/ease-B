enum DayOfWeek {
    SUNDAY
    MONDAY
    TUESDAY
    WEDNESDAY
    THURSDAY
    FRIDAY
    SATURDAY
}

enum AppointmentStatus {
    PENDING
    CONFIRMED
    CANCELLED
    COMPLETED
    NO_SHOW
}

enum WebinarStatus {
    SCHEDULED
    ONGOING
    COMPLETED
    CANCELLED
}

model Skills {
    id           String         @id @default(uuid())
    name         String         @unique
    description  String
    createdAt    DateTime       @default(now())
    updatedAt    DateTime       @updatedAt
    mentorSkills MentorSkills[]
}

model Services {
    id             String           @id @default(uuid())
    name           String           @unique
    description    String
    createdAt      DateTime         @default(now())
    updatedAt      DateTime         @updatedAt
    mentorServices MentorServices[]
}

model Mentor {
    id           String               @id @default(uuid())
    about        String
    skills       MentorSkills[]
    languages    String[]
    timezone     String
    availability MentorAvailability[]
    services     MentorServices[]
    webinars     Webinar[]
    appointments Appointment[]
    userId       String               @unique
    user         User                 @relation(fields: [userId], references: [id])
    createdAt    DateTime             @default(now())
    updatedAt    DateTime             @updatedAt
}

model MentorSkills {
    id       String @id @default(uuid())
    mentorId String
    mentor   Mentor @relation(fields: [mentorId], references: [id], onDelete: Cascade)
    skillId  String
    skill    Skills @relation(fields: [skillId], references: [id], onDelete: Cascade)
}

model MentorServices {
    id           String        @id @default(uuid())
    mentorId     String
    mentor       Mentor        @relation(fields: [mentorId], references: [id], onDelete: Cascade)
    serviceId    String
    service      Services      @relation(fields: [serviceId], references: [id], onDelete: Cascade)
    price        Int
    currency     String        @default("USD")
    duration     Int // Duration in minutes
    isActive     Boolean       @default(true)
    createdAt    DateTime      @default(now())
    updatedAt    DateTime      @updatedAt
    appointments Appointment[]

    @@unique([mentorId, serviceId])
    @@map("mentor_services")
}

model MentorAvailability {
    id        String    @id @default(uuid())
    mentorId  String
    mentor    Mentor    @relation(fields: [mentorId], references: [id], onDelete: Cascade)
    dayOfWeek DayOfWeek
    startTime String
    endTime   String
    isActive  Boolean   @default(true)
    createdAt DateTime  @default(now())
    updatedAt DateTime  @updatedAt

    @@unique([mentorId, dayOfWeek, startTime, endTime])
    @@map("mentor_availability")
}

model Webinar {
    id           String            @id @default(uuid())
    mentorId     String
    mentor       Mentor            @relation(fields: [mentorId], references: [id], onDelete: Cascade)
    title        String
    description  String?
    price        Int
    currency     String
    maxAttendees Int?
    scheduledAt  DateTime
    duration     Int
    status       WebinarStatus     @default(SCHEDULED)
    meetingLink  String?
    recordingUrl String?
    attendees    WebinarAttendee[]
    appointments Appointment[]
    createdAt    DateTime          @default(now())
    updatedAt    DateTime          @updatedAt

    @@map("webinars")
}

model WebinarAttendee {
    id        String    @id @default(uuid())
    webinarId String
    webinar   Webinar   @relation(fields: [webinarId], references: [id], onDelete: Cascade)
    userId    String
    user      User      @relation(fields: [userId], references: [id], onDelete: Cascade)
    status    String    @default("REGISTERED")
    joinedAt  DateTime?
    createdAt DateTime  @default(now())
    updatedAt DateTime  @updatedAt

    @@unique([webinarId, userId])
    @@map("webinar_attendees")
}

model Appointment {
    id          String            @id @default(uuid())
    mentorId    String
    mentor      Mentor            @relation(fields: [mentorId], references: [id], onDelete: Cascade)
    userId      String
    user        User              @relation(fields: [userId], references: [id], onDelete: Cascade)
    serviceId   String?
    service     MentorServices?   @relation(fields: [serviceId], references: [id])
    webinarId   String?
    webinar     Webinar?          @relation(fields: [webinarId], references: [id])
    scheduledAt DateTime
    duration    Int
    status      AppointmentStatus @default(PENDING)
    notes       String?
    meetingLink String?
    rating      Int?
    review      String?
    createdAt   DateTime          @default(now())
    updatedAt   DateTime          @updatedAt

    @@map("appointments")
}
